function transferBoard(){apiRequest("transferBoardOwnership",{login:document.getElementById("fieldTransferLogin").value.trim(),boardUri:boardIdentifier},function(e,t){"ok"===e?window.location.pathname="/"+boardIdentifier+"/":alert(e+": "+JSON.stringify(t))})}function deleteBoard(){apiRequest("deleteBoard",{boardUri:boardIdentifier},function(e,t){"ok"===e?window.location.pathname="/":alert(e+": "+JSON.stringify(t))})}function processFilterCell(e){var t=e.getElementsByClassName("deleteJsButton")[0];t.style.display="inline",t.onclick=function(){removeFilter(e.getElementsByClassName("filterIdentifier")[0].value)},e.getElementsByClassName("deleteFormButton")[0].style.display="none"}function removeFilter(e){apiRequest("deleteFilter",{boardUri:boardIdentifier,filterIdentifier:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function addFilter(){var e=document.getElementById("fieldOriginalTerm").value.trim(),t=document.getElementById("fieldReplacementTerm").value.trim();return e.length&&t.length?e.length>32||t.length>32?void alert("Both fields cannot exceed 32 characters."):void apiRequest("createFilter",{boardUri:boardIdentifier,originalTerm:e,replacementTerm:t},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))}):void alert("Both fields are mandatory.")}function processCell(e){var t=e.getElementsByClassName("saveJsButton")[0];t.style.display="inline",e.getElementsByClassName("saveFormButton")[0].style.display="none";var n=e.getElementsByClassName("roleCombo")[0],o=e.getElementsByClassName("userIdentifier")[0].value;t.onclick=function(){saveUser(o,n)}}function saveUser(e,t){setUser(e,t.options[t.selectedIndex].value)}function addUser(){var e=document.getElementById("newStaffCombo");setUser(document.getElementById("fieldLogin").value.trim(),e.options[e.selectedIndex].value)}function setUser(e,t){apiRequest("setGlobalRole",{login:e,role:+t},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function processHashBanCell(e){var t=e.getElementsByClassName("liftJsButton")[0];t.style.display="inline",t.onclick=function(){liftHashBan(e.getElementsByClassName("idIdentifier")[0].value)},e.getElementsByClassName("liftFormButton")[0].style.display="none"}function liftHashBan(e){apiRequest("liftHashBan",{hashBanId:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function placeHashBan(){var e=document.getElementById("hashField").value.trim(),t={hash:e};boardUri&&(t.boardUri=boardUri),apiRequest("placeHashBan",t,function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function processRangeBanCell(e){var t=e.getElementsByClassName("liftJsButton")[0];t.style.display="inline",t.onclick=function(){liftBan(e.getElementsByClassName("idIdentifier")[0].value)},e.getElementsByClassName("liftFormButton")[0].style.display="none"}function liftBan(e){apiRequest("liftBan",{banId:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function placeRangeBan(){var e=document.getElementById("rangeField").value.trim(),t={range:e};boardUri&&(t.boardUri=boardUri),apiRequest("placeRangeBan",t,function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}function setupReportButtons(){for(var e=document.getElementById("reportDiv"),t=0;t<e.childNodes.length;t++)processReportCell(e.childNodes[t])}function processReportCell(e){var t=e.getElementsByClassName("closeJsButton")[0];t.style.display="inline",t.onclick=function(){closeReport(e.getElementsByClassName("idIdentifier")[0].value)},e.getElementsByClassName("closeFormButton")[0].style.display="none"}function closeReport(e){apiRequest("closeReport",{reportId:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}if("bannerManagement"===pageId){var processBannerCell=function(e){var t=e.getElementsByClassName("deleteJsButton")[0];showElement(t),t.onclick=function(){removeBanner(e.getElementsByClassName("bannerIdentifier")[0].value)},removeElement(e.getElementsByClassName("deleteFormButton")[0])},addBanner=function(){var e=document.getElementById("files").files[0];if(!e)return void alert("You must select a file");var t=new FileReader;t.onloadend=function(n){var o=[{name:e.name,content:t.result}];apiRequest("createBanner",{files:o,boardUri:boardIdentifier},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})},t.readAsDataURL(e)},removeBanner=function(e){apiRequest("deleteBanner",{bannerId:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})},boardIdentifier=document.getElementById("boardIdentifier").value;showElement(document.getElementById("addJsButton")),removeElement(document.getElementById("addFormButton"));for(var bannersDiv=document.getElementById("bannersDiv"),j=0;j<bannersDiv.childNodes.length;j++)processBannerCell(bannersDiv.childNodes[j])}if("bans"===pageId)for(var processBanCell=function(e){var t=e.getElementsByClassName("liftJsButton")[0];t.style.display="inline",t.onclick=function(){liftBan(e.getElementsByClassName("idIdentifier")[0].value)},e.getElementsByClassName("liftFormButton")[0].style.display="none"},liftBan=function(e){apiRequest("liftBan",{banId:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})},bansDiv=document.getElementById("bansDiv"),j=0;j<bansDiv.childNodes.length;j++)processBanCell(bansDiv.childNodes[j]);if("boardManagement"===pageId){var saveSettings=function(){var e=document.getElementById("boardNameField").value.trim(),t=document.getElementById("boardDescriptionField").value.trim(),n=document.getElementById("anonymousNameField").value.trim();if(!e.length||!e.length)return void alert("Both name and description are mandatory.");var o=[];document.getElementById("disableIdsCheckbox").checked&&o.push("disableIds"),document.getElementById("allowCodeCheckbox").checked&&o.push("allowCode"),document.getElementById("disableCaptchaCheckbox").checked&&o.push("disableCaptcha"),document.getElementById("forceAnonymityCheckbox").checked&&o.push("forceAnonymity"),apiRequest("setBoardSettings",{boardName:e,anonymousName:n,boardDescription:t,boardUri:boardIdentifier,settings:o},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})},processVolunteerCell=function(e){var t=e.getElementsByClassName("removeJsButton")[0];t.style.display="inline",e.getElementsByClassName("removeFormButton")[0].style.display="none",t.onclick=function(){setVolunteer(e.getElementsByClassName("userIdentifier")[0].value,!1)}},addVolunteer=function(){setVolunteer(document.getElementById("addVolunteerFieldLogin").value.trim(),!0)},setVolunteer=function(e,t){apiRequest("setVolunteer",{login:e,add:t,boardUri:boardIdentifier},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})},transferBoard=function(){apiRequest("transferBoardOwnership",{login:document.getElementById("transferBoardFieldLogin").value.trim(),boardUri:boardIdentifier},function(e,t){"ok"===e?window.location.pathname="/"+boardIdentifier+"/":alert(e+": "+JSON.stringify(t))})},deleteBoard=function(){apiRequest("deleteBoard",{boardUri:boardIdentifier},function(e,t){"ok"===e?window.location.pathname="/":alert(e+": "+JSON.stringify(t))})},makeCssRequest=function(e){apiRequest("setCustomCss",{files:e||[],boardUri:boardIdentifier},function(t,n){document.getElementById("files").type="file",alert("ok"===t?e?"New CSS set.":"CSS deleted.":t+": "+JSON.stringify(n))})},setCss=function(){var e=document.getElementById("files").files[0];if(!e)return void makeCssRequest();var t=new FileReader;t.onloadend=function(n){makeCssRequest([{name:e.name,content:t.result}])},t.readAsDataURL(e)},boardIdentifier;if(document.getElementById("ownerControlDiv")){showElement(document.getElementById("addVolunteerJsButton")),removeElement(document.getElementById("addVolunteerFormButton")),showElement(document.getElementById("transferBoardJsButton")),removeElement(document.getElementById("transferBoardFormButton")),showElement(document.getElementById("deleteBoardJsButton")),removeElement(document.getElementById("deleteBoardFormButton")),showElement(document.getElementById("saveSettingsJsButton")),removeElement(document.getElementById("saveSettingsFormButton")),showElement(document.getElementById("cssJsButton")),removeElement(document.getElementById("cssFormButton")),boardIdentifier=document.getElementById("addVolunteerBoardIdentifier").value;for(var volunteerDiv=document.getElementById("volunteersDiv"),i=0;i<volunteerDiv.childNodes.length;i++)processVolunteerCell(volunteerDiv.childNodes[i])}setupReportButtons()}if("boardModeration"===pageId){var boardIdentifier;document.getElementById("transferJsButton").style.display="inline",document.getElementById("deleteJsButton").style.display="inline",document.getElementById("deleteFormButton").style.display="none",document.getElementById("transferFormButton").style.display="none",boardIdentifier=document.getElementById("boardTransferIdentifier").value}if("edit"===pageId){var boardIdentifier,threadIdentififer,postIdentifier;showElement(document.getElementById("saveJsButton")),removeElement(document.getElementById("saveFormButton")),boardIdentifier=document.getElementById("boardIdentifier").value;var threadElement=document.getElementById("threadIdentifier");threadElement?threadIdentififer=threadElement.value:postIdentifier=document.getElementById("postIdentifier").value;var save=function(){var e=document.getElementById("fieldMessage").value.trim();if(e.length)if(e.length>2048)alert("Message too long, keep it under 2048 characters.");else{var t={boardUri:boardIdentifier,message:e};postIdentifier?t.postId=postIdentifier:t.threadId=threadIdentififer,apiRequest("saveEdit",t,function(e,t){alert("ok"===e?"Posting edited.":e+": "+JSON.stringify(t))})}else alert("A message is mandatory.")}}if("filterManagement"===pageId){var boardIdentifier=document.getElementById("boardIdentifier").value;document.getElementById("addJsButton").style.display="inline",document.getElementById("addFormButton").style.display="none";for(var filtersDiv=document.getElementById("divFilters"),j=0;j<filtersDiv.childNodes.length;j++)processFilterCell(filtersDiv.childNodes[j])}if("globalManagement"===pageId){document.getElementById("addJsButton").style.display="inline",document.getElementById("addFormButton").style.display="none",setupReportButtons();for(var staffDiv=document.getElementById("divStaff"),i=0;i<staffDiv.childNodes.length;i++){var cell=staffDiv.childNodes[i];processCell(cell)}}if("hashBans"===pageId){var boardUri,boardIdentifier=document.getElementById("boardIdentifier");boardIdentifier&&(boardUri=boardIdentifier.value),document.getElementById("createFormButton").style.display="none",document.getElementById("createJsButton").style.display="inline";for(var hashBansDiv=document.getElementById("hashBansDiv"),j=0;j<hashBansDiv.childNodes.length;j++)processHashBanCell(hashBansDiv.childNodes[j])}if("rangeBans"===pageId){var boardUri,boardIdentifier=document.getElementById("boardIdentifier");boardIdentifier&&(boardUri=boardIdentifier.value),document.getElementById("createFormButton").style.display="none",document.getElementById("createJsButton").style.display="inline";for(var rangeBansDiv=document.getElementById("rangeBansDiv"),j=0;j<rangeBansDiv.childNodes.length;j++)processRangeBanCell(rangeBansDiv.childNodes[j])}if("ruleManagement"===pageId){var boardIdentifier=document.getElementById("boardIdentifier").value;showElement(document.getElementById("addJsButton")),removeElement(document.getElementById("addFormButton"));for(var processRuleCell=function(e){var t=e.getElementsByClassName("deleteJsButton")[0];showElement(t),removeElement(e.getElementsByClassName("deleteFormButton")[0]),t.onclick=function(){var t=e.getElementsByClassName("indexIdentifier")[0].value;apiRequest("deleteRule",{boardUri:boardIdentifier,ruleIndex:t},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))})}},rules=document.getElementsByClassName("ruleManagementCell"),i=0;i<rules.length;i++)processRuleCell(rules[i]);var addRule=function(){var e=document.getElementById("fieldRule").value.trim();e.length?e.length>512?alert("Rule too long, keep in under 512 characters."):apiRequest("createRule",{boardUri:boardIdentifier,rule:e},function(e,t){"ok"===e?location.reload(!0):alert(e+": "+JSON.stringify(t))}):alert("You can't inform a blank rule.")}}